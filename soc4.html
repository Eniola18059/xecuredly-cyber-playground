<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Lesson 4 – Computer Networks & Security (Expanded)</title>

  <style>
    :root {
      --bg: #0b1220;
      --card: #111a2e;
      --muted: #8aa0c3;
      --text: #e7eefc;
      --accent: #6ea8ff;
      --accent-2: #7ef0c1;
      --warning: #ffdf6e;
      --danger: #ff7e93;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,"Noto Sans",Helvetica,Arial}
    body{color:var(--text); background:linear-gradient(135deg,#0b1220 0%,#101b34 100%); -webkit-font-smoothing:antialiased;}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    header{position:sticky;top:0;z-index:20;backdrop-filter:saturate(160%) blur(8px);background:rgba(11,18,32,0.7);border-bottom:1px solid rgba(255,255,255,0.06)}
    .header-row{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .badge{display:inline-flex;align-items:center;gap:8px;font-weight:600;color:#0b1220;background:linear-gradient(135deg,var(--accent),var(--accent-2));padding:8px 12px;border-radius:999px;font-size:12px;text-transform:uppercase;letter-spacing:.06em}
    .hero{padding:28px 20px 8px}
    .title{font-size:clamp(28px,4vw,40px);line-height:1.15;margin:4px 0 10px}
    .subtitle{color:var(--muted);font-size:15px}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    .chip{padding:6px 10px;background:rgba(255,255,255,0.04);border-radius:999px;font-size:12px;color:var(--muted);border:1px solid rgba(255,255,255,0.03)}
    .card{background:radial-gradient(140% 120% at 100% 0%,#132349 0%,var(--card) 45%);border:1px solid rgba(255,255,255,0.06);border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.25);margin-top:16px}
    .list{margin:0;padding-left:18px}
    .list li{margin:8px 0}
    .callout{background:linear-gradient(180deg,rgba(126,240,193,.06),rgba(126,240,193,.02));border:1px solid rgba(126,240,193,.14);padding:12px 14px;border-radius:12px;margin-top:10px}
    .warn{background:linear-gradient(180deg,rgba(255,223,110,.06),rgba(255,223,110,.02));border:1px solid rgba(255,223,110,.14)}
    .long-read{line-height:1.75;font-size:15px}
    .small{font-size:13px;color:var(--muted)}
    .explain{margin-top:8px;background:rgba(0,0,0,0.18);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.02)}
    .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid rgba(255,255,255,.12);color:var(--text);padding:10px 14px;border-radius:12px;background:rgba(255,255,255,.05);cursor:pointer;font-weight:600}
    .btn.primary{background:linear-gradient(135deg,var(--accent),var(--accent-2));color:#0b1220;border:none}
    code{background:rgba(255,255,255,0.02);padding:2px 6px;border-radius:6px;font-family:monospace}

    /* === TTS BAR (responsive & accessible) === */
    .tts-bar{
      position:fixed;
      right:18px;
      bottom:18px;
      z-index:9999;
      background:rgba(6,10,18,0.9);
      color:#00ffcc;
      padding:10px 12px;
      border-radius:12px;
      box-shadow:0 10px 36px rgba(0,0,0,0.6);
      font-family:'Share Tech Mono',monospace;
      display:flex;
      gap:8px;
      align-items:center;
      backdrop-filter:blur(8px);
      min-width:260px;
      max-width:440px;
      transition:all .18s ease;
    }
    .tts-bar button{background:linear-gradient(45deg,#ff0080,#7928ca);border:none;color:#fff;padding:8px 10px;border-radius:8px;font-weight:700;cursor:pointer;min-width:44px}
    .tts-bar .small{padding:6px 8px;min-width:36px}
    .tts-bar .label{color:#00ffcc; font-family:inherit; font-weight:700; margin-left:6px; margin-right:4px;}
    .tts-bar select,.tts-bar input[type="range"]{background:rgba(255,255,255,0.04);color:#00ffcc;border:1px solid rgba(255,255,255,0.04);padding:6px;border-radius:8px;font-family:inherit;min-width:80px;max-width:220px}
    .tts-controls{display:flex;gap:8px;align-items:center;flex-wrap:nowrap}
    .tts-highlight{background:rgba(0,255,200,0.12);padding:2px 4px;border-radius:4px;transition:background .12s ease}

    /* mobile compact behaviour */
    @media (max-width:420px){
      .tts-bar{left:50%;right:auto;transform:translateX(-50%);bottom:12px;min-width:88%;max-width:calc(100% - 28px);padding:10px 12px;border-radius:14px;}
      .tts-bar .label{display:none}
      .tts-bar select,.tts-bar input[type="range"]{min-width:56px;max-width:140px;padding:5px}
      .tts-bar[data-compact="true"]{min-width:64px;max-width:64px;padding:8px;border-radius:999px;gap:0}
      .tts-bar[data-compact="true"] .tts-controls{display:none}
      .tts-bar button{min-width:36px;padding:6px 8px}
    }

    @media (min-width:421px) and (max-width:820px){
      .tts-bar{left:50%;right:auto;transform:translateX(-50%);bottom:16px;min-width:70%;max-width:720px;padding:10px 12px;border-radius:14px;}
      .tts-bar select{min-width:72px}
    }

    @media (min-width:821px) and (max-width:1200px){
      .tts-bar{right:18px;left:auto;bottom:18px;min-width:320px;max-width:480px;transform:none;}
    }

    .tts-bar:focus-within{outline:3px solid rgba(21,156,228,0.12);outline-offset:4px}

    /* === mobile back button (avoids overlapping TTS) === */
    .mobile-back-btn { display: none; }
    @media (max-width: 1024px) {
      .mobile-back-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        position: fixed;
        left: 16px;
        bottom: calc(14px + env(safe-area-inset-bottom));
        z-index: 9998;
        text-decoration: none;
        padding: 10px 14px;
        border-radius: 999px;
        background: rgba(255,255,255,0.98);
        color: #0b1220;
        font-weight: 700;
        box-shadow: 0 8px 28px rgba(2,6,23,0.36);
        -webkit-tap-highlight-color: transparent;
        transition: transform .12s ease, box-shadow .12s ease;
        pointer-events: auto;
        border: 1px solid rgba(0,0,0,0.06);
        backdrop-filter: blur(6px);
      }
      @media (max-width: 820px) {
        .mobile-back-btn { bottom: calc(14px + env(safe-area-inset-bottom) + 84px); left: 12px; padding: 9px 12px; }
      }
      @media (max-width: 420px) {
        .mobile-back-btn { left: 10px; bottom: calc(8px + env(safe-area-inset-bottom) + 84px); padding: 9px 12px; }
      }
    }

    /* injected desktop back button is styled inline by JS to avoid altering page CSS */
    @media (max-width:420px){ .container{padding:12px} .title{font-size:22px} }
  </style>
</head>
<body>
  <header>
    <div class="container header-row">
      <div style="display:flex;align-items:center;gap:12px">
        <span class="badge">Lesson 4</span>
        <div>
          <strong>Computer Networks & Security — Expanded</strong>
          <div class="small muted">Definitions • OSI/TCP-IP • Scanning • Enumeration • Threats • Labs</div>
        </div>
      </div>
      <div>
        <button class="btn ghost" id="toggleTheme" title="Toggle contrast">🌗 Theme</button>
      </div>
    </div>
  </header>

  <main class="container">
    <article class="lesson-content">

      <section class="hero card">
        <h1 class="title">Computer Networks & Security</h1>
        <p class="subtitle">An expanded, classroom-ready lesson covering network fundamentals, layered models (OSI/TCP-IP), scanning & enumeration techniques, common threats, and hands-on labs.</p>
        <div class="chips">
          <span class="chip">Networking</span>
          <span class="chip">OSI Model</span>
          <span class="chip">TCP/IP</span>
          <span class="chip">Nmap</span>
          <span class="chip">DDoS</span>
        </div>
      </section>

      <!-- Table of contents -->
      <section class="card" aria-labelledby="toc">
        <h2 id="toc" class="section-title">Table of Contents</h2>
        <ol class="list">
          <li>Definition of Computer Network</li>
          <li>Applications of Computer Networks</li>
          <li>Basic Terminologies</li>
          <li>Types of Computer Network</li>
          <li>Network Architecture: P2P & Client/Server</li>
          <li>Layered Architecture, OSI & TCP/IP</li>
          <li>Physical layer details (media, topology, devices)</li>
          <li>Network Scanning & Host Discovery</li>
          <li>Enumeration techniques</li>
          <li>Common Network Threats & Attacks</li>
          <li>Hands-on Labs & Exercises</li>
          <li>Further reading & references</li>
        </ol>
      </section>

      <!-- content sections (kept intact) -->
      <section class="card long-read" aria-labelledby="definition">
        <h2 id="definition" class="section-title">Definition of Computer Network</h2>
        <p>
          A <strong>computer network</strong> is the interconnection of two or more computers and devices using wired or wireless media so they can communicate and share resources.
          Networks enable collaboration, access to remote services, centralized management, and efficient data exchange.
        </p>
        <div class="explain">
          <p><strong>Examples:</strong> home Wi-Fi connecting phones and laptops; corporate LAN connecting desktops to file servers; the global Internet linking billions of devices.</p>
          <p class="small muted">Key idea: networks transform isolated computers into an ecosystem where information flows.</p>
        </div>
      </section>

      <section class="card long-read" aria-labelledby="applications">
        <h2 id="applications" class="section-title">Applications of Computer Networks</h2>
        <p>
          Networks are everywhere — they support communication, resource sharing, distributed computing, entertainment, e-commerce, remote access and more.
        </p>
        <ul class="list">
          <li><strong>Communication:</strong> email, chat, VoIP, video conferencing.</li>
          <li><strong>Shared resources:</strong> printers, NAS storage, databases.</li>
          <li><strong>Distributed services:</strong> web hosting, cloud computing, DNS.</li>
          <li><strong>Remote work:</strong> VPNs and remote desktop solutions.</li>
          <li><strong>Streaming & gaming:</strong> low-latency networks for multimedia delivery.</li>
        </ul>
        <div class="explain">
          <p class="small muted">When designing networks, balance throughput (bandwidth), responsiveness (latency), reliability (availability), and cost.</p>
        </div>
      </section>

      <section class="card long-read" aria-labelledby="terminology">
        <h2 id="terminology" class="section-title">Basic Terminologies</h2>
        <ul class="list">
          <li><strong>Host / Node:</strong> any device on the network (PC, server, phone).</li>
          <li><strong>IP Address:</strong> logical address (IPv4 or IPv6) used to route packets (e.g., <code>192.168.1.10</code>).</li>
          <li><strong>MAC Address:</strong> hardware address assigned to network interfaces (unique per NIC).</li>
          <li><strong>Packet:</strong> the unit of data sent across networks; contains headers, payload and sometimes trailers.</li>
          <li><strong>Bandwidth:</strong> capacity (e.g., Mbps, Gbps).</li>
          <li><strong>Latency:</strong> round-trip delay (ms).</li>
          <li><strong>Port:</strong> logical endpoint for network services (e.g., 80 for HTTP, 443 for HTTPS).</li>
        </ul>
        <div class="explain">
          <p>Analogy: IP addresses are like postal addresses, MACs like physical house identifiers, ports like rooms inside a house where specific services live.</p>
        </div>
      </section>

      <section class="card long-read" aria-labelledby="types-net">
        <h2 id="types-net" class="section-title">Types of Computer Network</h2>
        <p>Networks are categorized by size, geography, and purpose:</p>
        <ul class="list">
          <li><strong>PAN (Personal Area Network):</strong> short-range (Bluetooth, USB).</li>
          <li><strong>LAN (Local Area Network):</strong> a single building or campus (Ethernet switches, Wi-Fi APs).</li>
          <li><strong>MAN (Metropolitan Area Network):</strong> city-wide networks connecting multiple LANs.</li>
          <li><strong>WAN (Wide Area Network):</strong> long-distance links, often using ISP infrastructure (the Internet).</li>
          <li><strong>Cloud / Data Center networks:</strong> high-performance networks inside cloud providers or enterprise DCs.</li>
        </ul>
        <div class="explain">
          <p class="small muted">Different network types require different design choices (e.g., WANs emphasize routing and resilience; LANs emphasize switching and VLAN segmentation).</p>
        </div>
      </section>

      <section class="card long-read" aria-labelledby="architecture">
        <h2 id="architecture" class="section-title">Network Architecture: Peer-to-Peer vs Client/Server</h2>
        <h3>Peer-to-Peer (P2P)</h3>
        <p>In a P2P network, devices have equal status and can act as client and server simultaneously. Common in small home or ad-hoc networks and some file sharing systems.</p>
        <ul class="list">
          <li><strong>Advantages:</strong> low cost, simple setup, resilience — no single server dependency.</li>
          <li><strong>Disadvantages:</strong> poor centralized management, inconsistent backups, security challenges.</li>
        </ul>
        <h3>Client-Server</h3>
        <p>Clients request resources; servers provide them. This is the dominant model for enterprise and internet services.</p>
        <ul class="list">
          <li><strong>Advantages:</strong> centralized management, easier backups, better security controls.</li>
          <li><strong>Disadvantages:</strong> higher cost, single points of failure (mitigated by redundancy).</li>
        </ul>
        <div class="explain"><p class="small muted">Many real-world deployments are hybrid: client-server for core services and P2P for specific peer workflows.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="layered">
        <h2 id="layered" class="section-title">Layered Architecture & Why It Matters</h2>
        <p>Layering organizes network functions into separate responsibilities so systems are modular, interoperable, and easier to troubleshoot.</p>
        <h3>Core components of a layered model</h3>
        <ul class="list">
          <li><strong>Service:</strong> what a layer offers to the layer above.</li>
          <li><strong>Protocol:</strong> rules for communication with a peer layer on another host.</li>
          <li><strong>Interface:</strong> how a layer talks to the layer above/below locally.</li>
        </ul>
        <div class="explain"><p class="small muted">By separating concerns (e.g., routing vs reliability vs presentation), new technologies can replace individual layers without redesigning the whole stack.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="osi">
        <h2 id="osi" class="section-title">OSI Model (7 Layers) — Detailed</h2>
        <table style="width:100%;border-collapse:collapse">
          <thead>
            <tr style="text-align:left">
              <th style="padding:8px;border-bottom:1px solid rgba(255,255,255,0.04)">Layer</th>
              <th style="padding:8px;border-bottom:1px solid rgba(255,255,255,0.04)">Name</th>
              <th style="padding:8px;border-bottom:1px solid rgba(255,255,255,0.04)">What it does (short)</th>
            </tr>
          </thead>
          <tbody>
            <tr><td style="padding:8px">7</td><td style="padding:8px">Application</td><td style="padding:8px">Provides network services to applications (HTTP, SMTP, FTP).</td></tr>
            <tr><td style="padding:8px">6</td><td style="padding:8px">Presentation</td><td style="padding:8px">Data formatting, encryption, compression.</td></tr>
            <tr><td style="padding:8px">5</td><td style="padding:8px">Session</td><td style="padding:8px">Manages sessions and dialogs (connections, checkpoints).</td></tr>
            <tr><td style="padding:8px">4</td><td style="padding:8px">Transport</td><td style="padding:8px">End-to-end communication, flow & error control (TCP/UDP).</td></tr>
            <tr><td style="padding:8px">3</td><td style="padding:8px">Network</td><td style="padding:8px">Routing packets between networks (IP).</td></tr>
            <tr><td style="padding:8px">2</td><td style="padding:8px">Data Link</td><td style="padding:8px">Framing, MAC addressing, local error control.</td></tr>
            <tr><td style="padding:8px">1</td><td style="padding:8px">Physical</td><td style="padding:8px">Raw bit transmission over media (cables, radio).</td></tr>
          </tbody>
        </table>
        <div class="explain"><p class="small muted">Mnemonic (top→bottom): "All People Seem To Need Data Processing". Bottom→top: "Please Do Not Throw Sausage Pizza Away".</p></div>
      </section>

      <section class="card long-read" aria-labelledby="physical">
        <h2 id="physical" class="section-title">Physical Layer — Media, Topologies & Devices</h2>
        <h3>Transmission media</h3>
        <ul class="list">
          <li><strong>Wired:</strong> Twisted pair (Ethernet), Coax, Optical fiber (long distance, high bandwidth).</li>
          <li><strong>Wireless:</strong> Wi-Fi (802.11), Bluetooth, Cellular (4G/5G), Satellite.</li>
        </ul>
        <h3>Topologies</h3>
        <ul class="list">
          <li><strong>Star:</strong> devices connect to a central switch — common in modern LANs.</li>
          <li><strong>Bus:</strong> single backbone cable (legacy).</li>
          <li><strong>Ring:</strong> devices connected in a loop (token ring historically).</li>
          <li><strong>Mesh:</strong> highly redundant connections — used in resilient or large-scale networks.</li>
        </ul>
        <h3>Common devices</h3>
        <ul class="list">
          <li><strong>Hub:</strong> broadcast device (legacy; not smart).</li>
          <li><strong>Switch:</strong> frame-forwarding device using MAC tables (layer 2).</li>
          <li><strong>Router:</strong> forwards packets between networks using IP (layer 3).</li>
          <li><strong>Firewall:</strong> enforces network security policies.</li>
          <li><strong>Access Point:</strong> wireless connectivity provider.</li>
        </ul>
        <div class="explain"><p class="small muted">Design decisions here impact performance, resilience and security. Fiber gives speed but costs more; mesh gives redundancy at complexity cost.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="tcpip">
        <h2 id="tcpip" class="section-title">TCP/IP Protocol Suite (Internet Foundation)</h2>
        <p>TCP/IP is the practical model used by the Internet. It groups functions into fewer layers: Application, Transport (TCP/UDP), Internet (IP), and Network Access (link + physical).</p>
        <div class="explain"><p><strong>TCP</strong> provides reliable, ordered, error-checked delivery of a stream (used by HTTP, SMTP). <strong>UDP</strong> is connectionless and lower-overhead (used by DNS, VoIP, some games).</p><p class="small muted">Understanding both OSI and TCP/IP helps when mapping abstract concepts to real protocols and troubleshooting problems.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="scanning">
        <h2 id="scanning" class="section-title">Network Scanning — Overview</h2>
        <p>Network scanning is a reconnaissance phase used to discover hosts, open ports and services that help build an attack or audit surface. It is essential in both defensive inventory work and offensive assessments.</p>
        <h3>Objectives</h3>
        <ul class="list">
          <li>Find live hosts (host discovery).</li>
          <li>Detect open ports and services.</li>
          <li>Fingerprint operating systems and versions.</li>
          <li>Identify potential vulnerabilities and exposures.</li>
        </ul>
        <h3>Popular tool: Nmap</h3>
        <p class="small muted">Nmap is the de-facto open-source scanner. It can discover hosts, detect services and versions, and run scripts to probe for known issues.</p>
      </section>

      <section class="card long-read" aria-labelledby="hostdiscovery">
        <h2 id="hostdiscovery" class="section-title">Host Discovery (Techniques & Examples)</h2>
        <ul class="list">
          <li><strong>ARP Ping Scan</strong> — excellent on local networks; uses ARP to map IP↔MAC. <code>nmap -PR -sn 192.168.1.0/24</code></li>
          <li><strong>ICMP Ping Scan</strong> — sends ICMP Echo Requests. <code>nmap -PE -sn 10.0.0.0/24</code></li>
          <li><strong>TCP Ping Scan</strong> — probes specific TCP ports with SYN. <code>nmap -PS22,80 -sn target</code></li>
          <li><strong>UDP Ping Scan</strong> — useful where ICMP is blocked. <code>nmap -PU -sn target</code></li>
          <li><strong>IP Protocol Ping</strong> — pings by protocol type (<code>-PO</code>).</li>
        </ul>
        <div class="explain"><p class="small muted">Active scans are noisy and can trigger IDS/IPS — always have permission for offensive scans. Passive discovery (listening) is stealthier but may miss hosts that generate little traffic.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="portscan">
        <h2 id="portscan" class="section-title">Port Scanning — Methods & Commands</h2>
        <p>Port scanning reveals which service endpoints (ports) a host is accepting connections on. Common TCP scans:</p>
        <ul class="list">
          <li><strong>TCP Connect / Full Open (<code>-sT</code>):</strong> completes full TCP handshake. <code>nmap -sT target</code></li>
          <li><strong>SYN / Half-open (<code>-sS</code>):</strong> sends SYN and reads response without completing handshake—stealthier. <code>nmap -sS target</code></li>
          <li><strong>Xmas Scan (<code>-sX</code>):</strong> sets FIN/PSH/URG flags to infer port state. <code>nmap -sX target</code></li>
          <li><strong>FIN / NULL / Xmas:</strong> rely on TCP stack differences; less effective on modern stacks with hardened responses.</li>
          <li><strong>UDP Scan (<code>-sU</code>):</strong> probes UDP services (slower and often requires elevated privileges). <code>nmap -sU target</code></li>
        </ul>
        <div class="explain"><p class="small muted">Combine scans with version detection (<code>-sV</code>) and script scanning (<code>-sC</code>) to get richer information: <code>nmap -sS -sV -sC -A target</code>.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="enumeration">
        <h2 id="enumeration" class="section-title">Enumeration — Extracting Useful Data</h2>
        <p>Enumeration is the phase where you extract detailed information: services and versions, user accounts, shares, DNS records, and application internals. It's targeted and often requires authenticated or advanced techniques.</p>
        <h3>Common enumeration techniques & commands</h3>
        <ul class="list">
          <li><strong>Service enumeration / banner grabbing:</strong> <code>nmap -sV --script=banner target</code>.</li>
          <li><strong>SMB / Share enumeration:</strong> <code>enum4linux -a target</code> or <code>smbclient -L //<target></code>.</li>
          <li><strong>SNMP enumeration:</strong> <code>snmpwalk -v2c -c public target</code> (careful: community strings can leak sensitive info).</li>
          <li><strong>DNS enumeration:</strong> <code>dig +short axfr domain @ns</code>, <code>dig any</code> and subdomain enumeration tools.</li>
          <li><strong>Web enumeration:</strong> directory brute force using <code>gobuster</code> or <code>dirb</code> to find hidden endpoints.</li>
        </ul>
        <div class="explain"><p class="small muted">Enumeration is high value: finding a misconfigured service, a default admin account, or an open share can lead to privilege escalation inside a network.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="threats-list">
        <h2 id="threats-list" class="section-title">Common Network Threats & Attacks</h2>
        <ul class="list">
          <li><strong>Malware:</strong> viruses, worms, trojans, ransomware — delivered via email, web drive-by, or infected USBs.</li>
          <li><strong>Phishing & Social Engineering:</strong> attackers trick users into revealing credentials or running malicious code.</li>
          <li><strong>Man-in-the-Middle (MitM):</strong> intercepting and possibly altering traffic (ARP spoofing, rogue Wi-Fi hotspots).</li>
          <li><strong>Denial-of-Service (DoS) / DDoS:</strong> overwhelming resources to make services unavailable.</li>
          <li><strong>Eavesdropping / Sniffing:</strong> capturing packets on the network (useful if traffic is unencrypted).</li>
          <li><strong>Rogue devices:</strong> unauthorized routers or access points inside a network.</li>
        </ul>
        <div class="explain"><p class="small muted">Real-world example: WannaCry (2017) combined a worm with ransomware and used a leaked SMB exploit to propagate, causing global disruption. It underlines why patching and segmentation matter.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="didyouknow">
        <h2 id="didyouknow" class="section-title">Did You Know?</h2>
        <p>The first message sent over ARPANET on October 29, 1969 was <strong>“LO”</strong>. The intended "LOGIN" crashed the machine after the first two letters — a small but historic start to the networked age.</p>
        <div class="explain"><p class="small muted">This anecdote is a reminder: innovation often begins imperfectly but scales rapidly — the Internet grew from a simple experiment to a global infrastructure.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="labs">
        <h2 id="labs" class="section-title">Hands-on Labs & Exercises</h2>
        <p>Practical exercises to reinforce the theory. Always perform scanning/enumeration in a lab or with explicit permission.</p>
        <ul class="list">
          <li><strong>Lab 1 — Local host discovery:</strong> run <code>nmap -sn 192.168.1.0/24</code> on a home network to see active devices. Observe ARP table (<code>arp -a</code>).</li>
          <li><strong>Lab 2 — Port & service discovery:</strong> scan a test VM with <code>nmap -sS -sV -p1-1000 target</code> and document services and versions.</li>
          <li><strong>Lab 3 — Banner grabbing & vuln mapping:</strong> use <code>nmap --script vuln target</code> (in a controlled lab) to see automated findings and learn false-positive handling.</li>
          <li><strong>Lab 4 — Enumeration:</strong> set up a Samba share and practice using <code>smbclient</code> and <code>enum4linux</code> to enumerate shares and users.</li>
          <li><strong>Lab 5 — Packet capture:</strong> use Wireshark to capture a simple HTTP request and see headers, then repeat with HTTPS to see encryption.</li>
        </ul>
        <div class="explain"><p class="small muted">Tip: use virtual labs like VirtualBox or cloud sandboxes and snapshots to avoid damaging real systems. Always document commands, timestamps, and observations.</p></div>
      </section>

      <section class="card long-read" aria-labelledby="refs">
        <h2 id="refs" class="section-title">Further Reading & References</h2>
        <ul class="list">
          <li>RFCs for TCP/IP and application protocols (IETF).</li>
          <li>"Computer Networking: A Top-Down Approach" — Kurose & Ross (textbook).</li>
          <li>Nmap documentation and official site: <code>nmap.org</code>.</li>
          <li>Wireshark user guide for packet analysis.</li>
        </ul>
        <div class="explain"><p class="small muted">If you're building a course, pair readings with labs and short quizzes for each major section (OSI, scanning, enumeration, threats).</p></div>
      </section>

      <section class="card" aria-labelledby="share">
        <h2 id="share" class="section-title">Download / Export</h2>
        <p class="small muted">Download the lesson as plain text or copy as Markdown for LMS handouts.</p>
        <div style="display:flex;gap:12px;align-items:center;margin-top:8px">
          <button class="btn primary" id="downloadNotes">📥 Download Notes (Text)</button>
          <button class="btn" id="copyMarkdown">📋 Copy Markdown</button>
        </div>
      </section>

    </article>

    <footer class="container">
      <p>© Learning Playground – Computer Networks & Security • Lesson 4 (Expanded)</p>
    </footer>
  </main>

  <!-- Mobile Back button (mobile & tablet only) -->
  <a href="cyber-index.html" class="mobile-back-btn" aria-label="Back to lessons (mobile)">
    <span class="mobile-back-icon" aria-hidden="true">◀</span>
    <span class="mobile-back-text">Lessons</span>
  </a>

  <!-- TTS Control Bar (responsive & collapsible) -->
  <div id="ttsBar" class="tts-bar" aria-hidden="false" data-compact="false" role="region" aria-label="Text to Speech Controls">
    <button id="ttsCollapse" class="btn small" aria-label="Collapse TTS" title="Collapse">≡</button>

    <div class="tts-controls" role="group" aria-label="TTS controls">
      <button id="ttsPlay" title="Play">▶</button>
      <button id="ttsPause" class="small" title="Pause">⏸</button>
      <button id="ttsStop" class="small" title="Stop">⏹</button>

      <span class="label">Voice</span>
      <select id="ttsVoices" aria-label="Select voice"></select>

      <span class="label">Rate</span>
      <input id="ttsRate" type="range" min="0.6" max="2" step="0.1" value="1" />

      <span class="label">Pitch</span>
      <input id="ttsPitch" type="range" min="0.6" max="2" step="0.1" value="1" />

      <button id="ttsToggleAuto" class="small" title="Auto-read on load">A</button>
    </div>
  </div>

  <script>
    /* Theme toggle (persist) */
    (function () {
      const themeBtn = document.getElementById('toggleTheme');
      const keyTheme = 'lesson4-theme';
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const applyTheme = (mode) => {
        if (mode === 'light') {
          document.documentElement.style.setProperty('--bg','#f7f9ff');
          document.documentElement.style.setProperty('--card','#ffffff');
          document.documentElement.style.setProperty('--text','#0b1220');
          document.documentElement.style.setProperty('--muted','#4a5875');
        } else {
          document.documentElement.style.setProperty('--bg','#0b1220');
          document.documentElement.style.setProperty('--card','#111a2e');
          document.documentElement.style.setProperty('--text','#e7eefc');
          document.documentElement.style.setProperty('--muted','#8aa0c3');
        }
      };
      const storedTheme = localStorage.getItem(keyTheme) || (prefersDark ? 'dark' : 'light');
      applyTheme(storedTheme);
      themeBtn.addEventListener('click', () => {
        const cur = localStorage.getItem(keyTheme) || storedTheme;
        const next = cur === 'dark' ? 'light' : 'dark';
        localStorage.setItem(keyTheme, next);
        applyTheme(next);
      });
    })();

    /* Download notes as text */
    document.getElementById('downloadNotes').addEventListener('click', () => {
      const title = 'Lesson4_Computer_Networks_Notes_Expanded.txt';
      const nodes = document.querySelectorAll('.lesson-content h1, .lesson-content h2, .lesson-content p, .lesson-content li');
      const lines = [];
      nodes.forEach(n => {
        const tag = n.tagName.toLowerCase();
        if (tag === 'h1' || tag === 'h2') lines.push('\n' + n.innerText + '\n');
        else lines.push(n.innerText);
      });
      const content = lines.join('\n');
      const blob = new Blob([content], {type:'text/plain'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = title; document.body.appendChild(a); a.click();
      setTimeout(()=>{ URL.revokeObjectURL(url); a.remove(); }, 500);
    });

    /* Copy Markdown */
    document.getElementById('copyMarkdown').addEventListener('click', async () => {
      const nodes = document.querySelectorAll('.lesson-content h1, .lesson-content h2, .lesson-content p, .lesson-content li');
      let md = '';
      nodes.forEach(n => {
        const tag = n.tagName.toLowerCase();
        if (tag === 'h1') md += `# ${n.innerText}\n\n`;
        else if (tag === 'h2') md += `## ${n.innerText}\n\n`;
        else if (tag === 'li') md += `- ${n.innerText}\n`;
        else md += `${n.innerText}\n\n`;
      });
      try { await navigator.clipboard.writeText(md); alert('Copied lesson content as Markdown to clipboard.'); }
      catch(e){ alert('Could not copy to clipboard.'); }
    });

    /* Enhanced responsive TTS module for this lesson */
    (function () {
      const HOME = 'cyber-index.html';
      const STORAGE_BASE = 'lesson4.cyber';
      const AUTO_KEY = 'lesson4.tts.auto';
      const COMPACT_KEY = 'lesson4.ttsCompact';
      const RESUME_IDX = STORAGE_BASE + '.index';
      const MOBILE_BREAK = 820;

      const ttsBar = document.getElementById('ttsBar');
      const playBtn = document.getElementById('ttsPlay');
      const pauseBtn = document.getElementById('ttsPause');
      const stopBtn = document.getElementById('ttsStop');
      const voicesSelect = document.getElementById('ttsVoices');
      const rateInput = document.getElementById('ttsRate');
      const pitchInput = document.getElementById('ttsPitch');
      const autoBtn = document.getElementById('ttsToggleAuto');
      const collapseBtn = document.getElementById('ttsCollapse');
      const lesson = document.querySelector('.lesson-content') || document.body;

      if (!('speechSynthesis' in window)) {
        console.warn('TTS not available; hiding TTS bar.');
        if (ttsBar) ttsBar.style.display = 'none';
        return;
      }

      /* Inject desktop back button (non-invasive) */
      (function createDesktopBack(){
        if (document.querySelector('.desktop-back-btn')) return;
        const btn = document.createElement('button');
        btn.className = 'desktop-back-btn';
        btn.title = 'Back to lessons';
        btn.setAttribute('aria-label','Back to lessons');
        btn.innerText = '◀ Lessons';
        Object.assign(btn.style, {
          position: 'fixed',
          left: '18px',
          top: '18px',
          zIndex: 9999,
          padding: '8px 12px',
          borderRadius: '10px',
          border: '1px solid rgba(255,255,255,0.06)',
          background: 'rgba(255,255,255,0.02)',
          color: 'var(--text)',
          fontWeight: 700,
          cursor: 'pointer',
          backdropFilter: 'blur(6px)'
        });
        document.body.appendChild(btn);
        function update() { btn.style.display = window.innerWidth <= MOBILE_BREAK ? 'none' : 'inline-flex'; }
        update();
        window.addEventListener('resize', update);
        btn.addEventListener('click', () => { window.location.href = HOME; });
      })();

      /* state */
      const S = {
        voices: [],
        sentences: [],
        idx: parseInt(localStorage.getItem(RESUME_IDX) || '0', 10) || 0,
        utterance: null,
        auto: localStorage.getItem(AUTO_KEY) === 'true',
        compact: (localStorage.getItem(COMPACT_KEY) === 'true') || (window.matchMedia('(max-width:820px)').matches),
        readingOnScroll: false,
        muted: false
      };

      /* load voices robustly */
      function loadVoices() {
        return new Promise((resolve) => {
          let v = speechSynthesis.getVoices();
          if (v.length) { S.voices = v; resolve(v); return; }
          speechSynthesis.onvoiceschanged = () => { v = speechSynthesis.getVoices(); S.voices = v; resolve(v); };
          setTimeout(() => { v = speechSynthesis.getVoices(); S.voices = v; resolve(v); }, 1200);
        });
      }
      async function populateVoices() {
        const voices = await loadVoices();
        if (!voicesSelect) return;
        voicesSelect.innerHTML = '';
        voices.forEach(v => {
          const opt = document.createElement('option');
          opt.value = v.voiceURI || v.name;
          opt.textContent = `${v.name} (${v.lang})${v.default ? ' — default' : ''}`;
          voicesSelect.appendChild(opt);
        });
        const stored = localStorage.getItem('tts.voice');
        if (stored) voicesSelect.value = stored;
      }
      populateVoices();

      /* build sentences with node references */
      function buildSentences() {
        const nodes = lesson.querySelectorAll('h1,h2,h3,p,li');
        const arr = [];
        nodes.forEach(n => {
          const txt = n.innerText.trim();
          if (!txt) return;
          const parts = txt.split(/(?<=[.?!])\s+/);
          parts.forEach(p => { if (p && p.trim()) arr.push({ text: p.trim(), node: n }); });
        });
        S.sentences = arr;
      }

      /* highlighting helpers */
      function clearHighlights() {
        const els = lesson.querySelectorAll('.tts-highlight');
        els.forEach(el => el.classList.remove('tts-highlight'));
      }
      function highlightNode(node) {
        clearHighlights();
        if (!node) return;
        node.classList.add('tts-highlight');
        try { node.scrollIntoView({ behavior: 'smooth', block: 'center' }); } catch (e) {}
      }

      /* device-aware defaults */
      function deviceDefaultRate() {
        const w = window.innerWidth;
        if (w <= 420) return 0.95;
        if (w <= 820) return 1.0;
        return 1.08;
      }

      /* speak an object */
      function speakObj(obj) {
        if (!obj || !obj.text) { S.idx++; return; }
        if (speechSynthesis.speaking || speechSynthesis.pending) speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(obj.text);
        const voiceURI = (voicesSelect && voicesSelect.value) || localStorage.getItem('tts.voice') || '';
        const selected = S.voices.find(v => v.voiceURI === voiceURI) || S.voices.find(v => v.default) || S.voices[0];
        if (selected) u.voice = selected;
        u.rate = rateInput ? parseFloat(rateInput.value) : deviceDefaultRate();
        u.pitch = pitchInput ? parseFloat(pitchInput.value) : 1.0;
        u.volume = S.muted ? 0 : 1;
        u.onstart = () => highlightNode(obj.node);
        u.onend = () => {
          S.idx++;
          localStorage.setItem(RESUME_IDX, String(S.idx));
          if (S.idx < S.sentences.length) {
            setTimeout(() => speakObj(S.sentences[S.idx]), 110);
          } else {
            S.idx = 0;
            localStorage.setItem(RESUME_IDX, '0');
            clearHighlights();
          }
        };
        S.utterance = u;
        speechSynthesis.speak(u);
      }

      /* controls */
      function play(index) {
        if (!S.sentences.length) buildSentences();
        if (typeof index === 'number') S.idx = index;
        if (S.idx >= S.sentences.length) S.idx = 0;
        if (speechSynthesis.paused) return speechSynthesis.resume();
        speakObj(S.sentences[S.idx]);
      }
      function pauseToggle() {
        if (speechSynthesis.speaking && !speechSynthesis.paused) speechSynthesis.pause();
        else if (speechSynthesis.paused) speechSynthesis.resume();
      }
      function stop() {
        if (speechSynthesis.speaking || speechSynthesis.pending) speechSynthesis.cancel();
        S.idx = 0;
        localStorage.setItem(RESUME_IDX, '0');
        clearHighlights();
      }
      function speakText(text) {
        if (!text || !text.trim()) return;
        if (speechSynthesis.speaking || speechSynthesis.pending) speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        const voiceURI = (voicesSelect && voicesSelect.value) || localStorage.getItem('tts.voice') || '';
        const selected = S.voices.find(v => v.voiceURI === voiceURI) || S.voices[0];
        if (selected) u.voice = selected;
        u.rate = rateInput ? parseFloat(rateInput.value) : deviceDefaultRate();
        u.pitch = pitchInput ? parseFloat(pitchInput.value) : 1.0;
        speechSynthesis.speak(u);
      }
      function toggleAuto() {
        S.auto = !S.auto;
        localStorage.setItem(AUTO_KEY, S.auto ? 'true' : 'false');
        if (autoBtn) autoBtn.style.opacity = S.auto ? '1' : '0.6';
      }
      function setCompact(flag) {
        if (!ttsBar) return;
        ttsBar.setAttribute('data-compact', flag ? 'true' : 'false');
        localStorage.setItem(COMPACT_KEY, flag ? 'true' : 'false');
      }

      /* wire UI handlers */
      playBtn && playBtn.addEventListener('click', () => { play(0); });
      pauseBtn && pauseBtn.addEventListener('click', pauseToggle);
      stopBtn && stopBtn.addEventListener('click', stop);
      voicesSelect && voicesSelect.addEventListener('change', () => localStorage.setItem('tts.voice', voicesSelect.value));
      rateInput && rateInput.addEventListener('input', () => localStorage.setItem('tts.rate', rateInput.value));
      pitchInput && pitchInput.addEventListener('input', () => localStorage.setItem('tts.pitch', pitchInput.value));
      if (autoBtn) { autoBtn.style.opacity = S.auto ? '1' : '0.6'; autoBtn.addEventListener('click', toggleAuto); }
      if (collapseBtn) collapseBtn.addEventListener('click', () => { const cur = ttsBar.getAttribute('data-compact') === 'true'; setCompact(!cur); });

      /* initial compact */
      (function initCompact(){
        const stored = localStorage.getItem(COMPACT_KEY);
        const shouldDefault = window.matchMedia('(max-width:820px)').matches;
        const compact = stored === null ? shouldDefault : (stored === 'true');
        setCompact(compact);
      })();

      /* restore rate/pitch/voice */
      (function restore(){
        const r = localStorage.getItem('tts.rate');
        const p = localStorage.getItem('tts.pitch');
        const v = localStorage.getItem('tts.voice');
        if (r && rateInput) rateInput.value = r;
        if (p && pitchInput) pitchInput.value = p;
        if (v && voicesSelect) setTimeout(()=> { try { voicesSelect.value = v; } catch(e){} }, 600);
      })();

      /* responsive adjustments */
      function handleResize() {
        const narrow = window.matchMedia('(max-width:420px)').matches;
        const tablet = window.matchMedia('(max-width:820px)').matches && !narrow;
        const userSet = localStorage.getItem(COMPACT_KEY);
        if (userSet === null) {
          if (narrow) setCompact(true);
          else setCompact(false);
        }
        if (voicesSelect) {
          if (narrow) voicesSelect.style.maxWidth = '120px';
          else if (tablet) voicesSelect.style.maxWidth = '180px';
          else voicesSelect.style.maxWidth = '240px';
        }
        const desktopBtn = document.querySelector('.desktop-back-btn');
        if (desktopBtn) desktopBtn.style.display = window.innerWidth <= MOBILE_BREAK ? 'none' : 'inline-flex';
      }
      window.addEventListener('resize', handleResize);
      window.addEventListener('orientationchange', () => setTimeout(handleResize, 260));
      handleResize();

      /* keyboard shortcuts */
      window.addEventListener('keydown', (e) => {
        const tag = (e.target && e.target.tagName || '').toLowerCase();
        if (tag === 'input' || tag === 'textarea' || e.target.isContentEditable) return;
        if (e.code === 'Space') { e.preventDefault(); if (speechSynthesis.speaking && !speechSynthesis.paused) pauseToggle(); else if (speechSynthesis.paused) pauseToggle(); else play(S.idx || 0); }
        else if (e.key === 's' || e.key === 'S') stop();
        else if (e.key === 'b' || e.key === 'B') window.location.href = HOME;
        else if (e.key === '+' || e.key === '=') { if (rateInput) { rateInput.value = Math.min(parseFloat(rateInput.value) + 0.1, parseFloat(rateInput.max)); localStorage.setItem('tts.rate', rateInput.value); } }
        else if (e.key === '-') { if (rateInput) { rateInput.value = Math.max(parseFloat(rateInput.value) - 0.1, parseFloat(rateInput.min)); localStorage.setItem('tts.rate', rateInput.value); } }
        else if (e.key === 'm' || e.key === 'M') { S.muted = !S.muted; }
        else if (e.key === 'r' || e.key === 'R') { const sel = window.getSelection().toString().trim(); if (sel) speakText(sel); }
        else if (e.key === 'a' || e.key === 'A') toggleAuto();
        else if (e.key === 't' || e.key === 'T') { S.readingOnScroll = !S.readingOnScroll; alert('Read-on-scroll: ' + (S.readingOnScroll ? 'ON' : 'OFF')); }
      });

      /* double-tap to toggle play/pause on mobile */
      (function doubleTap() {
        let last = 0;
        document.addEventListener('touchend', (ev) => {
          const now = Date.now();
          if (now - last < 350) {
            if (speechSynthesis.speaking && !speechSynthesis.paused) pauseToggle();
            else play(S.idx || 0);
            last = 0;
            return;
          }
          last = now;
        }, { passive: true });
      })();

      /* read-on-scroll using IntersectionObserver */
      (function readOnScroll() {
        if (!('IntersectionObserver' in window)) return;
        const io = new IntersectionObserver((entries) => {
          if (!S.readingOnScroll) return;
          entries.forEach(en => {
            if (en.isIntersecting && en.intersectionRatio > 0.6) {
              const node = en.target;
              const idx = S.sentences.findIndex(s => s.node === node);
              if (idx >= 0) { S.idx = idx; play(idx); }
            }
          });
        }, { threshold: [0.6] });
        function observe() {
          const nodes = lesson.querySelectorAll('h1,h2,h3,p,li');
          nodes.forEach(n => io.observe(n));
        }
        observe();
        const mo = new MutationObserver(observe);
        mo.observe(lesson, { childList: true, subtree: true });
      })();

      /* expose API */
      window.CyberEnh = {
        play: () => play(0),
        pause: () => pauseToggle(),
        stop: () => stop(),
        speakText: (t) => speakText(t),
        toggleAutoRead: () => toggleAuto(),
        selectVoice: (nameOrURI) => {
          if (!voicesSelect || !nameOrURI) return;
          const opt = Array.from(voicesSelect.options).find(o => o.value === nameOrURI || o.textContent.includes(nameOrURI));
          if (opt) { voicesSelect.value = opt.value; localStorage.setItem('tts.voice', opt.value); }
        },
        getState: () => ({ idx: S.idx, auto: S.auto, muted: S.muted })
      };

      /* auto-play if allowed */
      window.addEventListener('load', () => {
        buildSentences();
        if (S.auto) {
          try {
            play(S.idx || 0);
          } catch (e) {
            console.warn('Auto TTS blocked by browser, user must press Play to start.');
          }
        }
      });

      /* little hint for first-time visitors */
      (function hint() {
        const key = STORAGE_BASE + '.hint';
        if (!localStorage.getItem(key)) {
          setTimeout(()=> console.info('TTS shortcuts: Space play/pause • S stop • B back • +/- speed • R read selection • A toggle auto'), 1000);
          localStorage.setItem(key, '1');
        }
      })();

    })();
  </script>
</body>
</html>
